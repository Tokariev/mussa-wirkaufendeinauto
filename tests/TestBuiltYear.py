import unittest
import os
from BuiltYear import BuiltYear
from dao import get_connection

class TestBuiltYear(unittest.TestCase):
    def setUp(self):
        self.cut = BuiltYear()
        self.connection = get_connection()

    def test_fetch_built_years(self):
        BMW = '130'
        BMW_3er = '10'
        act = self.cut.fetch_built_years(self.connection, BMW_3er)
        exp = [
            (115, '10', '2022'),
            (116, '10', '2021'),
            (117, '10', '2020'),
            (118, '10', '2019'),
            (119, '10', '2018'),
            (120, '10', '2017'),
            (121, '10', '2016'),
            (122, '10', '2015'),
            (123, '10', '2014'),
            (124, '10', '2013'),
            (125, '10', '2012'),
            (126, '10', '2011'),
            (127, '10', '2010'),
            (128, '10', '2009'),
            (129, '10', '2008'),
            (130, '10', '2007'),
            (131, '10', '2006'),
            (132, '10', '2005'),
            (133, '10', '2004'),
            (134, '10', '2003'),
            (135, '10', '2002'),
            (136, '10', '2001'),
            (137, '10', '2000'),
            (138, '10', '1999'),
            (139, '10', '1998'),
            (140, '10', '1997'),
            (141, '10', '1996'),
            (142, '10', '1995'),
            (143, '10', '1994'),
            (144, '10', '1993'),
            (145, '10', '1992'),
            (146, '10', '1991'),
            (147, '10', '1990'),
            (148, '10', '1989'),
            (149, '10', '1988'),
            (150, '10', '1987'),
            (151, '10', '1986'),
            (152, '10', '1985'),
            (153, '10', '1984'),
            (154, '10', '1983'),
            (155, '10', '1982'),
            (156, '10', '1981'),
            (157, '10', '1980'),
            (158, '10', '1979'),
            (159, '10', '1978'),
            (160, '10', '1977'),
            (161, '10', '1976'),
            (162, '10', '1975')
        ]
        self.assertEqual(exp, act)