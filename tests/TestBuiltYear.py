import unittest
import os
from BuiltYear import BuiltYear
from dao import get_connection

class TestBuiltYear(unittest.TestCase):
    def setUp(self):
        self.cut = BuiltYear()
        self.connection = get_connection()

    def test_fetch_built_years(self):
        BMW = '130'
        BMW_3er = '10'
        # Compare size of table
        exp = [
            (115, 2022, 10),
            (116, 2021, 10),
            (117, 2020, 10),
            (118, 2019, 10),
            (119, 2018, 10),
            (120, 2017, 10),
            (121, 2016, 10),
            (122, 2015, 10),
            (123, 2014, 10),
            (124, 2013, 10),
            (125, 2012, 10),
            (126, 2011, 10),
            (127, 2010, 10),
            (128, 2009, 10),
            (129, 2008, 10),
            (130, 2007, 10),
            (131, 2006, 10),
            (132, 2005, 10),
            (133, 2004, 10),
            (134, 2003, 10),
            (135, 2002, 10),
            (136, 2001, 10),
            (137, 2000, 10),
            (138, 1999, 10),
            (139, 1998, 10),
            (140, 1997, 10),
            (141, 1996, 10),
            (142, 1995, 10),
            (143, 1994, 10),
            (144, 1993, 10),
            (145, 1992, 10),
            (146, 1991, 10),
            (147, 1990, 10),
            (148, 1989, 10),
            (149, 1988, 10),
            (150, 1987, 10),
            (151, 1986, 10),
            (152, 1985, 10),
            (153, 1984, 10),
            (154, 1983, 10),
            (155, 1982, 10),
            (156, 1981, 10),
            (157, 1980, 10),
            (158, 1979, 10),
            (159, 1978, 10),
            (160, 1977, 10),
            (161, 1976, 10),
            (162, 1975, 10)
        ]
        act = self.cut.fetch_built_years(self.connection, BMW_3er)
        self.assertEqual(exp, act)